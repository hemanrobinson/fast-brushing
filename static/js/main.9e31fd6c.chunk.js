(this.webpackJsonpbrush=this.webpackJsonpbrush||[]).push([[0],{138:function(e,t,i){},139:function(e,t,i){},141:function(e,t,i){},145:function(e,t,i){"use strict";i.r(t);var a=i(1),s=i.n(a),r=i(34),n=i.n(r),o=(i(138),i(3)),c=i(155),l=i(5),h=function(e){};h.isSelected=[],h.deselectAll=function(){h.isSelected.fill(!1)},h.getColumnNames=function(){return["isSelected","A","B","A * B","sin( A / B )"]},h.getDomain=function(e,t){return[-1.5,1.5]},h.values=[],h.getValues=function(e){if(h.values.length!==e){var t=l.c(0,.5);h.values=[];for(var i=0;i<e;i++){var a=t(),s=t();h.values[i]=[!1,a,s,a*s,0===s?0:Math.sin(a/s)]}}return h.values};var d=h,u=function(e){};u.draw=function(e,t,i,a,s,r,n){var o=s.getContext("2d"),c=d.getColumnNames();o.fillStyle="#000000",o.fontSize="14px";var l=c[n];o.fillText(l,e+i/2-o.measureText(l).width/2,t+a-a/2+4),o.fontSize="10px",l=(""+d.getDomain(r,n)[0]).slice(0,4),o.fillText(l,e+4,t+a-4),l=(""+d.getDomain(r,n)[1]).slice(0,3),o.fillText(l,e+i-3-o.measureText(l).width,t+12)};var b=u,j=function(e){};j.padding=10,j.normalize=function(e){var t=e.x,i=e.y,a=e.width,s=e.height;return a<0&&(t+=a,a=-a),s<0&&(i+=s,s=-s),{x:t,y:i,width:a,height:s}},j.isWithin=function(e,t,i){var a=j.normalize(t);return void 0!==i&&(a.x-=i,a.y-=i,a.width+=2*i,a.height+=2*i),a.x<=e.x&&e.x<a.x+a.width&&a.y<=e.y&&e.y<a.y+a.height},j.draw=function(e,t,i,a,s,r,n,o,c,h,u){var b=s.getContext("2d"),p=j.padding,f=d.getValues(r),m=l.e().domain(d.getDomain(r,n)).range([e+p,e+i-p]),g=l.e().domain(d.getDomain(r,o)).range([t+a-p,t+p]),x=u;if(void 0===x){var v=(x=b.createImageData(i,a)).data;f.forEach((function(s){var r=m(s[n])-e,l=g(s[o])-t;if(0<=r&&r<i&&0<=l&&l<a){var h=Math.floor(l)*(4*i)+4*Math.floor(r);v[h]=Math.round(0+v[h]*(1-c)),v[h+1]=Math.round(0+v[h+1]*(1-c)),v[h+2]=Math.round(0+v[h+2]*(1-c)),v[h+3]=Math.round(255*c+v[h+3]*(1-c))}}))}var w=b.createImageData(i,a);w.data.set(x.data);var O=w.data;if(void 0!==h)h.forEach((function(s){var r=m(f[s][n])-e,l=g(f[s][o])-t;if(0<=r&&r<i&&0<=l&&l<a){var h=Math.floor(l)*(4*i)+4*Math.floor(r);O[h]=Math.round(255+O[h]*(1-c))}}));else{var y=0;f.forEach((function(s){if(d.isSelected[y]){var r=m(s[n])-e,l=g(s[o])-t;if(0<=r&&r<i&&0<=l&&l<a){var h=Math.floor(l)*(4*i)+4*Math.floor(r);O[h]=Math.round(255+O[h]*(1-c))}}y++}))}return b.putImageData(w,e,t,p,p,i-2*p,a-2*p),x},j.select=function(e,t,i,a,s,r,n,o){var c=j.padding,h=[],u=d.getValues(s),b=l.e().domain(d.getDomain(s,r)).range([e+c,e+i-c]),p=l.e().domain(d.getDomain(s,n)).range([t+a-c,t+c]),f=b.invert(Math.min(o.x,o.x+o.width)),m=b.invert(Math.max(o.x,o.x+o.width)),g=p.invert(Math.max(o.y,o.y+o.height)),x=p.invert(Math.min(o.y,o.y+o.height)),v=0;return u.forEach((function(e){d.isSelected[v]=f<=e[r]&&e[r]<m&&g<=e[n]&&e[n]<x,d.isSelected[v]&&h.push(v),v++})),h};var p=j,f=(i(139),i(0)),m=function e(t){var i=Object(a.useRef)(),s=t.nData,r=t.opacity,n=200,c=200,h=d.getColumnNames().length,u=(h-1)*n,b=(h-1)*c;return Object(a.useEffect)((function(){var t=l.f(i.current.childNodes[1]);t.selectAll("*").remove();var a=t.append("g").selectAll("g").data(l.b(l.d(h-1),l.d(h-1))).join("g").attr("transform",(function(e){var t=Object(o.a)(e,2),i=t[0],a=t[1];return"translate(".concat(i*n,",").concat(a*c,")")})),u=l.a().extent([[2,2],[n,c]]).on("start",(function(t){if(t.sourceEvent){var i=t.sourceEvent.target.parentNode;e.brushNode!==i&&(l.f(e.brushNode).call(u.move,null),e.brushNode=i),e.selectedRows=[],d.deselectAll()}})).on("brush",(function(t){if(e.selectedRows=[],d.deselectAll(),t.selection){var a=t.sourceEvent?t.sourceEvent.offsetX:400,o=t.sourceEvent?t.sourceEvent.offsetY:200,l=t.selection[0][0],h=t.selection[0][1],u=t.selection[1][0],b=t.selection[1][1],j=Math.floor(a/n),f=Math.floor(o/c),m=j*n,g=f*c;e.selectedRows=j===f?[]:p.select(m,g,n,c,s,j+1,f+1,{x:m+l,y:g+h,width:u-l,height:b-h})}e.draw(n,c,i,s,r,!1)})).on("end",(function(t){e.draw(n,c,i,s,r,!0)}));a.call(u),e.brush=u,e.brushNode=t.node().firstChild.childNodes[9],l.f(e.brushNode).call(u.move,[[60,60],[100,100]])})),Object(f.jsxs)("div",{ref:i,children:[Object(f.jsx)("canvas",{width:u,height:b}),Object(f.jsx)("svg",{width:u,height:b})]})};m.bitmaps=void 0,m.selectedRows=[],m.brush=void 0,m.brushNode=void 0,m.clear=function(){m.selectedRows=[],d.deselectAll(),m.bitmaps=void 0},m.draw=function(e,t,i,a,s,r){if(i){var n=i.current.firstChild,o=n.getContext("2d"),c=d.getColumnNames().length;if(o){if(r){o.clearRect(0,0,(c-1)*e,(c-1)*t),o.strokeStyle="#939ba1";for(var l=1;l<c-1;l++)o.moveTo(l*e+.5,0),o.lineTo(l*e+.5,(c-1)*t),o.moveTo(0,l*t+.5),o.lineTo((c-1)*e,l*t+.5);o.stroke()}var h=!m.bitmaps;h&&(m.bitmaps=[]);for(var u=1;u<c;u++)for(var j=1;j<c;j++){var f=(u-1)*e,g=(j-1)*t;u===j?r&&b.draw(f,g,e,t,n,a,u):h?(void 0===m.bitmaps[u-1]&&(m.bitmaps[u-1]=[]),m.bitmaps[u-1][j-1]=p.draw(f,g,e,t,n,a,u,j,s,m.selectedRows)):p.draw(f,g,e,t,n,a,u,j,s,m.selectedRows,m.bitmaps[u-1][j-1])}}}};var g=m,x=(i(141),i.p+"static/media/becker.ed8ef60d.png"),v=i.p+"static/media/cleveland.70d2e3e7.png",w=function e(){var t=Object(a.useState)(e.getPower(12)),i=Object(o.a)(t,2),s=i[0],r=i[1],n=Object(a.useState)(.5),l=Object(o.a)(n,2),h=l[0],d=l[1];return Object(f.jsxs)("div",{className:"Column",children:[Object(f.jsxs)("div",{className:"Description",children:[Object(f.jsx)("h1",{children:"Optimized Brushing"}),Object(f.jsx)("p",{children:"Brushing is a basic technique of exploratory data analysis, developed in the 1970s and 1980s.  Back then, analysts were happy to brush a few hundred points.  On modern hardware, we can brush many more."}),Object(f.jsx)("p",{children:"Drag the brush to select the points.  Drag the edges to resize the brush.  Drag a rectangle in any plot to create a new brush."}),Object(f.jsx)("p",{children:"Use the sliders to adjust the number of points and their transparency."}),Object(f.jsx)(g,{nData:s,opacity:h}),Object(f.jsx)("br",{})]}),Object(f.jsxs)("div",{className:"GridControls",children:[Object(f.jsx)("label",{children:"Points per Plot:"}),Object(f.jsx)(c.a,{defaultValue:12,step:1,min:6,max:15,valueLabelDisplay:"auto",marks:!0,valueLabelFormat:function(t){var i=e.getPower(t);return i>=1e4&&(i=i/1e3+"K"),i},onChangeCommitted:function(t,i){g.clear(),r(e.getPower(i))}}),Object(f.jsx)("span",{}),Object(f.jsx)("label",{children:"Transparency:"}),Object(f.jsx)(c.a,{defaultValue:.5,step:.01,min:0,max:.99,valueLabelDisplay:"auto",onChangeCommitted:function(e,t){g.clear(),d(1-t)}})]}),Object(f.jsxs)("div",{className:"Description",children:[Object(f.jsx)("h2",{children:"Design Notes"}),Object(f.jsxs)("p",{children:["This implementation uses code from the ",Object(f.jsx)("a",{href:"https://observablehq.com/collection/@d3/d3-brush",children:"d3-brush collection"}),"."]}),Object(f.jsxs)("p",{className:"center",children:[Object(f.jsx)("a",{href:"https://www.datavis.ca/milestones/index.php?group=1975%2B&mid=ms259",children:Object(f.jsx)("img",{title:"Dr. Richard Becker",alt:"Dr. Richard Becker",src:x})}),"\xa0\xa0\xa0\xa0\xa0",Object(f.jsx)("a",{href:"https://www.datavis.ca/milestones/index.php?group=1975%2B&mid=ms259",children:Object(f.jsx)("img",{title:"Dr. William Cleveland",alt:"Dr. William Cleveland",src:v})}),Object(f.jsx)("br",{})]}),Object(f.jsxs)("p",{children:["This design derives from the ",Object(f.jsx)("a",{href:"http://www.sci.utah.edu/~kpotter/Library/Papers/becker:1987:BS/index.html",children:"scatter plot matrix"})," of ",Object(f.jsx)("a",{href:"https://www.researchgate.net/scientific-contributions/Richard-A-Becker-7076158",children:"Richard Becker"})," and ",Object(f.jsx)("a",{href:"https://www.cerias.purdue.edu/site/people/faculty/view/709",children:"William Cleveland"})," (Becker and Cleveland, 1987)."]}),Object(f.jsx)("p",{children:'The goal of this graph is not to locate points, but to find patterns in the data.  So the scatter plot matrix displays no axes, only data ranges.  This maximizes Tufte\'s "Data-Ink Ratio" (Tufte, 1983).'}),Object(f.jsx)("p",{children:"Colors are chosen to emphasize the data.   Black on white gives maximum emphasis.  The red selection color draws attention.  The grid, being less important, is gray."}),Object(f.jsx)("p",{children:"For the same reason, the brush could also be gray; but usability tests pointed out that the standard selection color is blue (Ho, 2016).  Following standard design patterns eases the user's learning curve."}),Object(f.jsxs)("p",{children:["The ",Object(f.jsx)("a",{href:"https://github.com/d3/d3-brush",children:"d3 brush"})," is ",Object(f.jsx)("em",{children:"persistent"})," rather than ",Object(f.jsx)("em",{children:"transient"}),".  A persistent brush reduces errors, by enabling the user to resize the brush (Tidwell, 2010).  A persistent brush also helps users share the path of their exploration, through screen shots for example."]}),Object(f.jsx)("p",{children:"Transparency shows density (Wegman and Luo, 2002).  This gives scatter plots the power of contour plots, while still displaying individual points."}),Object(f.jsx)("p",{children:"The following optimizations improve performance:"}),Object(f.jsxs)("ol",{children:[Object(f.jsx)("li",{children:"Drawing on a single CANVAS avoids the need to allocate thousands of SVG objects."}),Object(f.jsx)("li",{children:"Each data point is drawn as a single pixel, to display large data sets with minimal drawing code."}),Object(f.jsx)("li",{children:"Deselected points are cached, so that drawing a plot requires only a fast copy, then drawing the selected points."}),Object(f.jsx)("li",{children:"Selected row indices are cached, so that drawing selected points iterates over a short list, not the entire data set."})]}),Object(f.jsx)("p",{children:"Performance varies, but a fast box can display 100,000 points per plot.  So in a 4x4 matrix, we can brush 1.2 million points.  As our hardware improves, we'll see this number grow."}),Object(f.jsx)("br",{}),Object(f.jsx)("h2",{children:"References"}),Object(f.jsxs)("ul",{children:[Object(f.jsxs)("li",{children:['Becker, R. and Cleveland, W. (1987). "Brushing Scatterplots". Technometrics. 29 (2): 127-142. ',Object(f.jsx)("a",{href:"https://doi.org/10.2307/1269768",children:"https://doi.org/10.2307/1269768"}),"."]}),Object(f.jsx)("br",{}),Object(f.jsxs)("li",{children:["Ho, Y. (2016). Personal communication. ",Object(f.jsx)("a",{href:"https://www.linkedin.com/in/yang-ho-94b14860/",children:"https://www.linkedin.com/in/yang-ho-94b14860/"})]}),Object(f.jsx)("br",{}),Object(f.jsxs)("li",{children:["Tidwell, J. (2010). Designing Interfaces: Patterns for Effective Interaction Design, Second Edition, 312-314.  Sebastopol CA: O'Reilly Media. ",Object(f.jsx)("a",{href:"https://www.oreilly.com/library/view/designing-interfaces-3rd/9781492051954/",children:"https://www.oreilly.com/library/view/designing-interfaces-3rd/9781492051954/"}),"."]}),Object(f.jsx)("br",{}),Object(f.jsxs)("li",{children:["Tufte, E. (1983). The Visual Display of Quantitative Information, First Edition, 91-105.  Cheshire CN: Graphics Press. ",Object(f.jsx)("a",{href:"https://www.edwardtufte.com/tufte/",children:"https://www.edwardtufte.com/tufte/"}),"."]}),Object(f.jsx)("br",{}),Object(f.jsxs)("li",{children:['Wegman, E. and Luo, Q. (2002). "On Methods of Computer Graphics for Visualizing Densities". Journal of Computational and Graphical Statistics 11, (1), 137-162. ',Object(f.jsx)("a",{href:"https://doi.org/10.1198/106186002317375659",children:"https://doi.org/10.1198/106186002317375659"}),"."]}),Object(f.jsx)("br",{})]})]}),Object(f.jsx)("a",{href:"https://github.com/hemanrobinson/brush/",children:"Code Shared on GitHub"})]})};w.getPower=function(e){return(e%3===0?1:e%3===1?2:5)*Math.pow(10,Math.floor(e/3))};var O=w;n.a.render(Object(f.jsx)(s.a.StrictMode,{children:Object(f.jsx)(O,{})}),document.getElementById("root"))}},[[145,1,2]]]);
//# sourceMappingURL=main.9e31fd6c.chunk.js.map