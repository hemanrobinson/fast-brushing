(this.webpackJsonpbrush=this.webpackJsonpbrush||[]).push([[0],{138:function(e,t,s){},139:function(e,t,s){},141:function(e,t,s){},145:function(e,t,s){"use strict";s.r(t);var a=s(1),i=s.n(a),r=s(34),n=s.n(r),o=(s(138),s(3)),l=s(155),c=s(5),h=function(e){};h.isSelected=[],h.deselectAll=function(){h.isSelected.fill(!1)},h.getColumnNames=function(){return["isSelected","A","B","A * B","sin( A / B )"]},h.getDomain=function(e,t){return[-1.5,1.5]},h.values=[],h.getValues=function(e){if(h.values.length!==e){var t=c.c(0,.5);h.values=[];for(var s=0;s<e;s++){var a=t(),i=t();h.values[s]=[!1,a,i,a*i,Math.sin(a/i)]}}return h.values};var d=h,u=function(e){};u.draw=function(e,t,s,a,i,r,n){var o=i.getContext("2d"),l=d.getColumnNames();o.fillStyle="#000000",o.fontSize="14px";var c=l[n];o.fillText(c,e+s/2-o.measureText(c).width/2,t+a-a/2+4),o.fontSize="10px",c=(""+d.getDomain(r,n)[0]).slice(0,4),o.fillText(c,e+4,t+a-4),c=(""+d.getDomain(r,n)[1]).slice(0,3),o.fillText(c,e+s-3-o.measureText(c).width,t+12)};var b=u,p=function(e){};p.padding=10,p.normalize=function(e){var t=e.x,s=e.y,a=e.width,i=e.height;return a<0&&(t+=a,a=-a),i<0&&(s+=i,i=-i),{x:t,y:s,width:a,height:i}},p.isWithin=function(e,t,s){var a=p.normalize(t);return void 0!==s&&(a.x-=s,a.y-=s,a.width+=2*s,a.height+=2*s),a.x<=e.x&&e.x<a.x+a.width&&a.y<=e.y&&e.y<a.y+a.height},p.draw=function(e,t,s,a,i,r,n,o,l,h,u){var b=i.getContext("2d"),j=p.padding,f=d.getValues(r),m=c.e().domain(d.getDomain(r,n)).range([e+j,e+s-j]),w=c.e().domain(d.getDomain(r,o)).range([t+a-j,t+j]),x=h;if(void 0===x){var g=(x=b.createImageData(s,a)).data;f.forEach((function(i){var r=m(i[n])-e,c=w(i[o])-t;if(0<=r&&r<s&&0<=c&&c<a){var h=Math.floor(c)*(4*s)+4*Math.floor(r);g[h]=Math.round(0+g[h]*(1-l)),g[h+1]=Math.round(0+g[h+1]*(1-l)),g[h+2]=Math.round(0+g[h+2]*(1-l)),g[h+3]=Math.round(255*l+g[h+3]*(1-l))}}))}var v=b.createImageData(s,a);v.data.set(x.data);var O=v.data;if(void 0!==u)u.forEach((function(i){var r=m(f[i][n])-e,c=w(f[i][o])-t;if(0<=r&&r<s&&0<=c&&c<a){var h=Math.floor(c)*(4*s)+4*Math.floor(r);O[h]=Math.round(255+O[h]*(1-l))}}));else{var y=0;f.forEach((function(i){if(d.isSelected[y]){var r=m(i[n])-e,c=w(i[o])-t;if(0<=r&&r<s&&0<=c&&c<a){var h=Math.floor(c)*(4*s)+4*Math.floor(r);O[h]=Math.round(255+O[h]*(1-l))}}y++}))}return b.putImageData(v,e,t,j,j,s-2*j,a-2*j),x},p.select=function(e,t,s,a,i,r,n,o){var l=p.padding,h=[],u=d.getValues(i),b=c.e().domain(d.getDomain(i,r)).range([e+l,e+s-l]),j=c.e().domain(d.getDomain(i,n)).range([t+a-l,t+l]),f=b.invert(Math.min(o.x,o.x+o.width)),m=b.invert(Math.max(o.x,o.x+o.width)),w=j.invert(Math.max(o.y,o.y+o.height)),x=j.invert(Math.min(o.y,o.y+o.height)),g=0;return u.forEach((function(e){d.isSelected[g]=f<=e[r]&&e[r]<m&&w<=e[n]&&e[n]<x,d.isSelected[g]&&h.push(g),g++})),h};var j=p,f=(s(139),s(0)),m=function e(t){var s=Object(a.useRef)(),i=t.nData,r=t.opacity,n=200,l=200,h=d.getColumnNames().length,u=(h-1)*n,b=(h-1)*l;return Object(a.useEffect)((function(){var t=c.f(s.current.childNodes[1]);t.selectAll("*").remove();var a=t.append("g").selectAll("g").data(c.b(c.d(h-1),c.d(h-1))).join("g").attr("transform",(function(e){var t=Object(o.a)(e,2),s=t[0],a=t[1];return"translate(".concat(s*n,",").concat(a*l,")")})),u=c.a().extent([[2,2],[n,l]]).on("start",(function(t){if(t.sourceEvent){var s=t.sourceEvent.target.parentNode;e.brushNode!==s&&(c.f(e.brushNode).call(u.move,null),e.brushNode=s),e.selectedRows=[],d.deselectAll()}})).on("brush end",(function(t){if(e.selectedRows=[],d.deselectAll(),t.selection){var a=t.sourceEvent?t.sourceEvent.offsetX:400,o=t.sourceEvent?t.sourceEvent.offsetY:200,c=t.selection[0][0],h=t.selection[0][1],u=t.selection[1][0],b=t.selection[1][1],p=Math.floor(a/n),f=Math.floor(o/l),m=p*n,w=f*l;e.selectedRows=p===f?[]:j.select(m,w,n,l,i,p+1,f+1,{x:m+c,y:w+h,width:u-c,height:b-h})}e.draw(n,l,s,i,r)}));a.call(u),e.brush=u,e.brushNode=t.node().firstChild.childNodes[9],c.f(e.brushNode).call(u.move,[[60,60],[100,100]])})),Object(f.jsxs)("div",{ref:s,children:[Object(f.jsx)("canvas",{width:u,height:b}),Object(f.jsx)("svg",{width:u,height:b})]})};m.bitmaps=void 0,m.selectedRows=[],m.brush=void 0,m.brushNode=void 0,m.clear=function(){m.selectedRows=[],d.deselectAll(),m.bitmaps=void 0},m.draw=function(e,t,s,a,i){if(s){var r=s.current.firstChild,n=r.getContext("2d"),o=d.getColumnNames().length;if(n){n.clearRect(0,0,(o-1)*e,(o-1)*t),n.strokeStyle="#939ba1";for(var l=1;l<o-1;l++)n.moveTo(l*e+.5,0),n.lineTo(l*e+.5,(o-1)*t),n.moveTo(0,l*t+.5),n.lineTo((o-1)*e,l*t+.5);n.stroke();var c=!m.bitmaps;c&&(m.bitmaps=[]);for(var h=1;h<o;h++)for(var u=1;u<o;u++){var p=(h-1)*e,f=(u-1)*t;h===u?b.draw(p,f,e,t,r,a,h):c?(void 0===m.bitmaps[h-1]&&(m.bitmaps[h-1]=[]),m.bitmaps[h-1][u-1]=j.draw(p,f,e,t,r,a,h,u,i,void 0,m.selectedRows)):j.draw(p,f,e,t,r,a,h,u,i,m.bitmaps[h-1][u-1],m.selectedRows)}}}};var w=m,x=(s(141),s.p+"static/media/cleveland.934d3552.png"),g=s.p+"static/media/tukey.a9cb1dea.png",v=function e(){var t=Object(a.useState)(e.getPower(12)),s=Object(o.a)(t,2),i=s[0],r=s[1],n=Object(a.useState)(.5),c=Object(o.a)(n,2),h=c[0],d=c[1];return Object(f.jsxs)("div",{className:"Column",children:[Object(f.jsxs)("div",{className:"Description",children:[Object(f.jsx)("h1",{children:"Optimized Brushing"}),Object(f.jsx)("p",{children:"Brushing is a basic technique of exploratory data analysis, developed in the 1970s and 1980s.  Back then, analysts were happy to brush a few hundred points.  On modern hardware, we can brush many more."}),Object(f.jsx)("p",{children:"Drag the brush to select the points.  Drag the edges to resize the brush.  Drag a rectangle in any plot to create a new brush."}),Object(f.jsx)("p",{children:"Use the sliders to adjust the number of points and their transparency."}),Object(f.jsx)(w,{nData:i,opacity:h}),Object(f.jsx)("br",{})]}),Object(f.jsxs)("div",{className:"GridControls",children:[Object(f.jsx)("label",{children:"Points per Plot:"}),Object(f.jsx)(l.a,{defaultValue:12,step:1,min:6,max:15,valueLabelDisplay:"auto",marks:!0,valueLabelFormat:function(t){var s=e.getPower(t);return s>=1e4&&(s=s/1e3+"K"),s},onChangeCommitted:function(t,s){w.clear(),r(e.getPower(s))}}),Object(f.jsx)("span",{}),Object(f.jsx)("label",{children:"Transparency:"}),Object(f.jsx)(l.a,{defaultValue:.5,step:.01,min:0,max:.99,valueLabelDisplay:"auto",onChangeCommitted:function(e,t){w.clear(),d(1-t)}})]}),Object(f.jsxs)("div",{className:"Description",children:[Object(f.jsx)("h2",{children:"Design Notes"}),Object(f.jsxs)("p",{children:["Parts of this implementation derive from code in ",Object(f.jsx)("a",{href:"https://observablehq.com/collection/@d3/d3-brush",children:"the d3-brush collection"}),"."]}),Object(f.jsxs)("p",{children:["This design derives from the ",Object(f.jsx)("a",{href:"http://www.sci.utah.edu/~kpotter/Library/Papers/becker:1987:BS/index.html",children:"scatter plot matrix"})," of (Becker and Cleveland, 1987).  Dr. Werner Stuetzle published his similar ",Object(f.jsx)("a",{href:"https://sites.stat.washington.edu/people/wxs/Visualization-papers/plot-windows.pdf",children:'"Plot Windows"'})," in the same year (Stuetzle, 1987)."]}),Object(f.jsxs)("p",{className:"center",children:[Object(f.jsx)("a",{href:"https://www.cerias.purdue.edu/site/people/faculty/view/709",children:Object(f.jsx)("img",{alt:"Dr. William Cleveland",src:x})}),Object(f.jsx)("br",{})]}),Object(f.jsxs)("p",{children:["Both systems built on the work of ",Object(f.jsx)("a",{href:"https://www.stat.berkeley.edu/~brill/Papers/life.pdf",children:"John Tukey"})," and colleagues a decade earlier (Fishkeller, Friedman, and Tukey, 1974).  The ",Object(f.jsx)("a",{href:"https://www.youtube.com/watch?v=B7XoW2qiFUA",children:"PRIM-9 video"})," shows how much these researchers achieved with the hardware available at the time."]}),Object(f.jsxs)("p",{className:"center",children:[Object(f.jsx)("a",{href:"https://www.stat.berkeley.edu/~brill/Papers/life.pdf",children:Object(f.jsx)("img",{alt:"Dr. John Tukey",src:g})}),Object(f.jsx)("br",{})]}),Object(f.jsx)("p",{children:"These systems were limited to small data sets, but their designers knew that Moore's Law was on their side.  They knew that computer hardware would eventually support much larger explorations."}),Object(f.jsx)("p",{children:"To minimize distraction, the scatter plot matrix displays no axes, but only data ranges.  This follows Tufte's \"Data-Ink Ratio\" (Tufte, 1983).  Axes aren't needed, because the goal is not to show locations of points, but to find patterns in the data."}),Object(f.jsx)("p",{children:"For the same reason, colors are chosen to emphasize the data.   Black on white gives maximum emphasis.  The red selection color draws attention.  The grid, being less important, is gray."}),Object(f.jsx)("p",{children:"Usability tests pointed out that the brush should be blue, the standard selection color (Ho, 2016).  Following standards eases the user's learning curve:  this blue object makes selections, like all the others."}),Object(f.jsxs)("p",{children:["Using d3's implementation, the brush is ",Object(f.jsx)("em",{children:"persistent"})," rather than ",Object(f.jsx)("em",{children:"transient"}),".  A persistent brush reduces errors, by enabling the user to resize the brush (Tidwell, 2010).  A persistent brush also helps users share the paths of their explorations, e.g. through screen shots."]}),Object(f.jsx)("p",{children:"Modern hardware enables transparency to show density (Wegman and Luo, 2002).  This gives scatter plots the power of contour plots, while still displaying individual points."}),Object(f.jsx)("p",{children:"The following optimizations improve performance:"}),Object(f.jsxs)("ol",{children:[Object(f.jsx)("li",{children:"CANVAS avoids the need to create many SVG objects."}),Object(f.jsx)("li",{children:"Each data point is shown as a single pixel, using transparency to show density, to minimize drawing code."}),Object(f.jsx)("li",{children:"Deselected points are cached, so drawing a plot requires only a fast copy, then drawing the selected points."}),Object(f.jsx)("li",{children:"Selected points are cached, so drawing iterates over a short list, not the entire data set."})]}),Object(f.jsx)("p",{children:"Performance varies, but a fast box can display 100,000 points per plot.  So a 4x4 matrix can brush 1.2 million points."}),Object(f.jsx)("br",{}),Object(f.jsx)("h2",{children:"References"}),Object(f.jsxs)("ul",{children:[Object(f.jsxs)("li",{children:['Becker, R. and Cleveland, W. (1987). "Brushing Scatterplots". Technometrics. 29 (2): 127-142. ',Object(f.jsx)("a",{href:"https://doi.org/10.2307/1269768",children:"https://doi.org/10.2307/1269768"}),"."]}),Object(f.jsx)("br",{}),Object(f.jsxs)("li",{children:["Fishkeller, Friedman, and Tukey (1974). \u201cPRIM-9: An Interactive Multidimensional Data Display and Analysis System\u201d SLAC-PUB-1408. Stanford, CA: Stanford Linear Accelerator Center. ",Object(f.jsx)("a",{href:"https://www.researchgate.net/publication/245345268_An_interactive_multidimensional_data_display_and_analysis_system",children:"https://www.researchgate.net/publication/245345268_An_interactive_multidimensional_data_display_and_analysis_system"}),"."]}),Object(f.jsx)("br",{}),Object(f.jsxs)("li",{children:["Ho, Y. (2016). Personal communication. ",Object(f.jsx)("a",{href:"https://www.linkedin.com/in/yang-ho-94b14860/",children:"https://www.linkedin.com/in/yang-ho-94b14860/"})]}),Object(f.jsx)("br",{}),Object(f.jsxs)("li",{children:['Stuetzle, W. (1987). "Plot Windows". Journal of the American Statistical Association. 82 (398): 466-475. ',Object(f.jsx)("a",{href:"https://sites.stat.washington.edu/people/wxs/Visualization-papers/plot-windows.pdf",children:"https://sites.stat.washington.edu/people/wxs/Visualization-papers/plot-windows.pdf"}),"."]}),Object(f.jsx)("br",{}),Object(f.jsxs)("li",{children:["Tidwell, J. (2010). Designing Interfaces: Patterns for Effective Interaction Design, Second Edition, 312-314 Sebastopol CA: O'Reilly Media. ",Object(f.jsx)("a",{href:"https://www.oreilly.com/library/view/designing-interfaces-3rd/9781492051954/",children:"https://www.oreilly.com/library/view/designing-interfaces-3rd/9781492051954/"}),"."]}),Object(f.jsx)("br",{}),Object(f.jsxs)("li",{children:["Tufte, E. (1983). The Visual Display of Quantitative Information, First Edition, 91-105.  Cheshire CN: Graphics Press. ",Object(f.jsx)("a",{href:"https://www.edwardtufte.com/tufte/",children:"https://www.edwardtufte.com/tufte/."})]}),Object(f.jsx)("br",{}),Object(f.jsxs)("li",{children:['Wegman, E. and Luo, Q. (2002). "On Methods of Computer Graphics for Visualizing Densities". Journal of Computational and Graphical Statistics 11, (1), 137-162. ',Object(f.jsx)("a",{href:"https://doi.org/10.1198/106186002317375659",children:"https://doi.org/10.1198/106186002317375659"}),"."]}),Object(f.jsx)("br",{})]})]}),Object(f.jsx)("a",{href:"https://github.com/hemanrobinson/brush/",children:"Code Shared on GitHub"})]})};v.getPower=function(e){return(e%3===0?1:e%3===1?2:5)*Math.pow(10,Math.floor(e/3))};var O=v;n.a.render(Object(f.jsx)(i.a.StrictMode,{children:Object(f.jsx)(O,{})}),document.getElementById("root"))}},[[145,1,2]]]);
//# sourceMappingURL=main.73ff2b13.chunk.js.map